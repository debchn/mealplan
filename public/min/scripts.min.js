var mealPlan={};mealPlan.ingredients=[],mealPlan.removeFromIngredients=function(e){var a=mealPlan.ingredients.indexOf(e.text().toLowerCase());mealPlan.ingredients.splice(a,1)},mealPlan.recipes=[],mealPlan.addRecipe=function(e){mealPlan.recipes.push(e),$.ajax({url:"http://api.yummly.com/v1/api/recipe/"+e,type:"GET",data:{format:"jsonp",_app_key:yumYum.apikey,_app_id:yumYum.appId},dataType:"jsonp",success:function(e){console.log(e),chosenMeals.add(e)}})},$(".noFrills .button").on("click",function(){if($(this).hasClass("selected"))$(this).removeClass("selected"),mealPlan.removeFromIngredients($(this)),$.isEmptyObject(mealPlan.ingredients)||yumYum.getRecipes(mealPlan.ingredients),yumYum.updateh2();else{$(this).addClass("selected"),$(this).attr("id",$(this).text().replace(/\s/,"").toLowerCase());var e=$(this).text().toLowerCase();mealPlan.ingredients.push(e),console.log(mealPlan.ingredients),yumYum.updateh2(),yumYum.getRecipes(mealPlan.ingredients)}}),$(".noThanks").on("click",function(){$(this).parent().slideUp(),$(this).remove()});var yumYum={};yumYum.apikey="f235b2cf2658a138b83a42670e7c1374",yumYum.appId="441e00da",yumYum.display=$(".recipes ul"),yumYum.ingredientsSpan=$("#ingredients"),yumYum.addButton=$(".manualAdd a"),yumYum.addField=$("#addField"),yumYum.addButton.on("click",function(){yumYum.addField.slideDown(),yumYum.manuallyAdd(yumYum.addField)}),yumYum.manuallyAdd=function(e){e.keypress(function(a){if(13===a.which){var i=e.val();e.val(""),i&&(mealPlan.ingredients.push(i),"editField"==e.attr("id")?(e.parent().html(i+"<a href='#' class='delete' onclick='event.preventDefault();'><i class='fa fa-times-circle'></i></a>"),$(".editable .delete").on("click",function(){var e=$(this).parent(),a=$("#"+e.text().replace(/\s/,""));a.length&&a.removeClass("selected"),mealPlan.removeFromIngredients(e),yumYum.updateh2(),$.isEmptyObject(mealPlan.ingredients)||yumYum.getRecipes(mealPlan.ingredients)})):(yumYum.updateh2(),e.slideUp()),yumYum.getRecipes(mealPlan.ingredients))}})},yumYum.updateh2=function(){$.isEmptyObject(mealPlan.ingredients)?(yumYum.ingredientsSpan.html("..."),yumYum.display.html("")):(yumYum.ingredientsSpan.html('<span class="editable">'+mealPlan.ingredients.join('<a href="#" class="delete" onclick="event.preventDefault();"><i class="fa fa-times-circle"></i></a></span> and <span class="editable">')+'<a href="#" class="delete" onclick="event.preventDefault();"><i class="fa fa-times-circle"></i></a></span>'),$("p.hint").show()),$(".editable").dblclick(function(){var e=$(this).text();mealPlan.removeFromIngredients($(this));var a=$("#"+e.replace(/\s/,""));a.length&&a.removeClass("selected"),$(this).html('<input type="text" id="editField" value="'+e+'">'),yumYum.manuallyAdd($("#editField"))}),$(".editable .delete").on("click",function(){var e=$(this).parent(),a=$("#"+e.text().replace(/\s/,""));a.length&&a.removeClass("selected"),mealPlan.removeFromIngredients(e),yumYum.updateh2(),$.isEmptyObject(mealPlan.ingredients)||yumYum.getRecipes(mealPlan.ingredients)})},yumYum.getRecipes=function(e){$.ajax({url:"http://api.yummly.com/v1/api/recipes",type:"GET",data:{format:"jsonp",_app_key:yumYum.apikey,_app_id:yumYum.appId,allowedIngredient:e},dataType:"jsonp",success:function(e){console.log(e.matches),yumYum.displayRecipes(e.matches)}})},yumYum.displayRecipes=function(e){yumYum.display.html(""),$.each(e,function(e,a){console.log(a);var i=$("<h3>").text(a.recipeName),l=$("<p>").text("From "+a.sourceDisplayName);if(a.smallImageUrls)var t=$("<img>").attr("src",a.smallImageUrls[0]);else var t=$("<img>");var n=$("<ul>").html("<li>"+a.ingredients.join("</li><li>")+"</li>"),s=$("<a>").html('<i class="fa fa-plus"></i> Add Recipe to Meal Plan').attr({href:"#",onclick:"event.preventDefault(); mealPlan.addRecipe('"+a.id+"');"}),m=$('<a href="#" onclick="event.preventDefault();" class="noThanks">').append($('<i class="fa fa-times">'));yumYum.display.append($('<li class="recipe">').append(i,l,t,n,s,m))}),$(".noThanks").on("click",function(){$(this).parent().slideUp(),$(this).remove()})};var chosenMeals={};chosenMeals.list=$(".chosenMeals ul"),chosenMeals.add=function(e){var a=$("<h3>").text(e.name),i=$("<p>").html("<a href='"+e.source.sourceRecipeUrl+"'>Original Recipe</a> from <a href='"+e.source.sourceSiteUrl+"'>"+e.source.sourceDisplayName+"</a>");if(e.images.length)var l=$("<img>").attr("src",e.images[0].hostedLargeUrl);else var l=$("<img>");var t=$("<p>").html("Yield: "+e.yield),n=$("<p>").html("Total time: "+e.totalTime),s=$("<ul>").html("<li>"+e.ingredientLines.join("</li><li>")+"</li>"),m=$("<span>").html(e.attribution.html),c=$('<a href="#" onclick="event.preventDefault();" class="noThanks">').append($('<i class="fa fa-times">'));chosenMeals.list.append($('<li class="meal">').append(a,i,l,t,n,s,m,c)),$(".noThanks").on("click",function(){$(this).parent().slideUp(),$(this).remove()})};